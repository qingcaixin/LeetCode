###threadlocal

  ThreadLocal是用来维护线程中的变量不被其他线程干扰而出现的一个结构，
            内部包含一个ThreadLocalMap类，该类为Thread类的一个局部变量，
            该Map存储的key为ThreadLocal对象自身，value为我们要存储的对象，
            这样一来，在不同线程中，持有的其实都是当前线程的变量副本，
            与其他线程完全隔离，以此来保证线程执行过程中不受其他线程的影响。
            当多个线程需要使用同一个对象,
            并且需要该对象具有的初始化值 的情景下使用ThreadLocal
            
###currenthashmap
HashTable是一个线程安全的类，它使用synchronized来锁住整张Hash表来实现线程安全，
即每次锁住整张表让线程独占。ConcurrentHashMap允许多个修改操作并发进行，其关键
在于使用了锁分离技术。它使用了多个锁来控制对hash表的不同部分进行的修改。
ConcurrentHashMap内部使用段(Segment)来表示这些不同的部分，
每个段其实就是一个小的Hashtable，它们有自己的锁。
只要多个修改操作发生在不同的段上，它们就可以并发进行。
ConcurrentHashMap使用分段锁技术，将数据分成一段一段的存储，
然后给每一段数据配一把锁，当一个线程占用锁访问其中一个段数据的时候，
其他段的数据也能被其他线程访问，能够实现真正的并发访问

  
    数据库四大特性
    
    原子性(Atomicity ):要么全部成功，要么全部失败。
    
    一致性(Consistency ):期望的结果和最重的结果一致
    
    隔离性(Isolation ):事物可以并发执行，但是，每个事物互不干扰。
    
    持久性(Durability ):事务一旦提交不能对数据库的改变是持久的

缓存问题

缓存穿透

  缓存穿透是指缓存和数据库中都没有的数据，而用户不断发起请求，

缓存击穿 

     缓存击穿是指缓存中没有但数据库中有的数据（一般是缓存时间到期），

这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力

分布式锁（synchronized是单JVM的），锁 Redis 集群。

缓存雪崩 

缓存雪崩是指缓存中数据大批量到过期时间，而查询数据量巨大，引起数据库压力过大甚至down机。

缓存有效期设置为区间：1000s -- 4600s；一个小时拉长了缓存数据可能到期的时间，从而降低了极短时间内的缓存数据到期问题。

缓存倾斜  

条件：高并发

访问高热读数据。明星结婚事件。。。

、在 Redis 集群的基础之上为每一台 Redis 服务器搭主从结构（读写分离式等）


   
    
